## モジュール構成

モジュールは大きく3つに分かれています。

1. `parent` は、jarとしてパッケージングして公開するモジュールの親です。
    - 子モジュールを持ちます。
2. `sample` は、使用例を示したモジュールの親です。
    - 子モジュールを持ち、目的ごとの使用例を示します。
    - パッケージング対象外です。
3. `report-aggregate` は、カバレージ取得するためのプラグイン「JaCoCo」のためのモジュールです。
    - JaCoCoは各モジュールの集約したレポートを出力するためのモジュールです。
    - パッケージング対象外です。

```
root
 ├─ pom.xml 
 ├─ parent   ・・・パッケージング対象とするモジュールの親プロジェクト
 │   ├─ pom.xml   
 │   ├─ module1  
 │   │   └─ pom.xml 
 │   └─ module2
 │       ├─ pom.xml
 │       ├─ module2-sub-module1
 │       │   └─ pom.xml 
 │       └─ module2-sub-module2
 │           └─ pom.xml 
 ├─ sample   ・・・サンプルの親プロジェクト。
 │   ├─ pom.xml 
 │   ├─ sample-sub-module1  
 │   │   └─ pom.xml 
 │   └─ sample-sub-module2
 │       └─ pom.xml 
 └─ report-aggregate  ・・・JaCoCo用のレポートを集約するためのプロジェクト。
     └─ pom.xml 
```

### rootプロジェクトの詳細

Mavenの `pom.xml` は、基本的に親モジュールの設定を引き継ぎます。

特に、jarにパッケージングして公開するモジュールのpom.xmlは専用の設定が必要になるため、その設定を rootのpom.xmlに記述すると 全体の適用されてしまいます。

そのため、目的ごとに親モジュールを間に入れて、親モジュールのpom.xmlで設定を行います。

rootプロジェクトの pom.xml は、主に次の設定を行います。

- プロジェクト全体の設定値を `<properties>` に定義。
    - `${revision}` : バージョンを定義し、各モジュールのバージョンを統一させます。
    - `${project.build.sourceEncoding}` : ソースの文字コード。
    - `${java.version}` : Javaのバージョン。
- デプロイ設定として、Sonatypeなどのプラグインの設定。
- プロジェクトのメタ情報の設定。
    - `<issuManagement>` : 課題管理のシステムへのリンク。
    - `<scm>` : リポジトリ管理のシステムへのリンク。
    - `<licenses>` : ライセンスへ種類。
    - `<organization>` : プロジェクトが所属する組織の説明。
    - `<developers>` : プロジェクトの開発者。
- 各モジュールで使用するプラグインの `<pluginManagement>` への定義。
    - 実際に使用するときにはプラグインのバージョンを省略することで、、`<pluginManagement>` に定義されたバージョンが参照され、全体でプラグインのバージョンを統一することができます。
- レポート出力の設定。
    - 各モジュールのレポートを集約する設定。

### parentモジュールの詳細

パッケージング対象となるテンプレートとして、以下の設定を定義します。

- コンパイルのオプションの定義。
   - Javaのバージョン指定。
   - LombokとQueryDSLなどのアノテーションプロセッサーを併用するときなどの設定。
- JUnit+JaCoCoの設定。
- 共通で使用するライブラリの依存関係の設定。
   - Lombok
   - JUnit
   - ログライブラリ関連
- レポート出力の設定として、rootプロジェクトの定義を上書く。

### sampleモジュールの詳細

使用例としてのテンプレートとして、基本的に何も定義しません。

基本的に、子モジュールで定義します。

### report-aggregateモジュールの詳細

JaCoCoのレポート結果を集約するためのプロジェクトとして以下を定義します。

- JaCoCoの ``report-aggregate`` のプラグイン設定。
- レポートを集約したいモジュールの依存関係の定義。
    - JaCoCoは、依存関係に追加されているモジュールのレポートを集約するので、依存関係に追加する必要があります。
